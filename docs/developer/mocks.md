To regenerate the controller-runtime client mocks we rely on `mockery` (v3.x at the moment). Because we wrap some of the generated types we cannot run `mockery` directly in `pkg/mocks`, so follow the steps below any time controller-runtime introduces a new method or signature.

Install mockery: https://vektra.github.io/mockery/latest/installation/

## Create

The helper interfaces live in `pkg/mockhelper/http.go`. If you ever need to recreate the file the contents should look like this:

```go
package mockhelper

import (
	"net/http"

	client "sigs.k8s.io/controller-runtime/pkg/client"
)

type Client interface {
	client.Client
}

type HttpClient interface {
	Do(req *http.Request) (*http.Response, error)
}
```

## Generate mocks

Run mockery once per interface, writing the results to the helper package (we copy the files into `pkg/mocks` afterwards). From the repo root:

```bash
mockery \
  --dir=pkg/mockhelper \
  --name=Client \
  --filename=Client.go \
  --structname=Client \
  --outpkg=mocks \
  --output=pkg/mockhelper \
  --with-expecter \
  --disable-version-string

mockery \
  --dir=pkg/mockhelper \
  --name=HttpClient \
  --filename=HttpClient.go \
  --structname=HttpClient \
  --outpkg=mocks \
  --output=pkg/mockhelper \
  --with-expecter \
  --disable-version-string
```

Copy the resulting files from `pkg/mockhelper/*.go` to `pkg/mocks/`.

## Customize the generated client

Delete the temporary files from `pkg/mockhelper/` once the copies have been taken, and then adjust the generated controllers-runtime client mock in `pkg/mocks/Client.go`.

Remove from controller-runtime client (`Client.go`):

```
// Client is an autogenerated mock type for the Client type
type Client struct {
	mock.Mock
}
````

Comment out methods: `NewClient()`, `SubResource(subResource string)` and `Status()`. All of these are already separately created in `mocks/helper.go`, since we want to modify the behavior of certain Status checks in our test code.
